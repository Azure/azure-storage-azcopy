parameters:
  - name: artifact_name
    type: string
  - name: download_path
    type: string
  - name: item_pattern
    type: string

steps:

  - task: ShellScript@2
    inputs:
      scriptPath: "$(System.DefaultWorkingDirectory)/azure-storage-azcopy/go_installer.sh"
      args: "$(System.DefaultWorkingDirectory)/"
    displayName: "GoTool Custom Setup"

  - task: DownloadBuildArtifacts@0
    displayName: 'Download Build Artifacts'
    inputs:
      artifactName: ${{ parameters.artifact_name }}
      downloadPath: ${{ parameters.download_path }}
      itemPattern: ${{ parameters.item_pattern }}

  - script: |
      ls -l
      result=$(ls -1 | wc -l)
      if [ $result -ne 1 ]; then
        exit 1
      fi
    displayName: 'List Downloaded Package'
    workingDirectory: ${{ parameters.download_path }}/${{ parameters.artifact_name }}
